---
- name: started and enabled nginx
  service:
   name: nginx
   state: started
   enabled: yes
  
- name: remove older Nginx Config
  file:
   path: /etc/nginx
   state: absent

- name: clone new Nginx config
  git:
   repo: https://github.com/MAELUP/apigateway-dev.git
   dest: /etc/nginx
    
- name: Change file ownership, group and permissions
  file:
   path: /etc/nginx
   owner: nginx
   group: nginx
   mode: '0755' 

- name: restart nginx
  service:
   name:  nginx
   state: restarted

- name: open service port_80
  firewalld:
   port: 80/tcp
   state: enabled
   permanent: yes
   immediate: yes

- name: open service port_8081
  firewalld:
   port: 8081/tcp
   permanent: yes
   state: enabled
   immediate: yes

- name: open service port_8080
  firewalld:
   port: 8080/tcp
   permanent: yes
   state: enabled
   immediate: yes
